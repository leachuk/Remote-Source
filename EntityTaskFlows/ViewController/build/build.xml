<?xml version="1.0" encoding="windows-1252" ?>
<!--Ant buildfile generated by Oracle JDeveloper-->
<!--Generated 01/07/2011 2:17:56 PM-->
<project name="ViewController" default="all" basedir="..">
  <property file="build/build.properties"/>
   <taskdef resource="net/sf/antcontrib/antcontrib.properties">
    <classpath>
     <pathelement location="${oracle.home.dir}/modules/net.sf.antcontrib_1.1.0.0_1-0b2/lib/ant-contrib.jar"/>
    </classpath>
  </taskdef>
  <target name="init">
    <tstamp/>
  </target>
  <target name="all" description="Build the project"
          depends="build, deploy-to-server"/>
  <target name="clean" description="Clean the project">
    <delete includeemptydirs="true" quiet="true">
      <fileset dir="${taskflows.jdeveloper.workspace.dir}/${taskflows.jdeveloper.project.name}/classes" includes="**/*"/>
      <fileset dir="${taskflows.jdeveloper.workspace.dir}/${taskflows.jdeveloper.model.project.name}/classes" includes="**/*"/>
      <fileset dir="${taskflows.deploy.dir}" includes="**/*"/>
    </delete>
  </target>
  <target name="build" description="Deploy JDeveloper profiles"
          depends="clean, init, pre-compile">
    <taskdef name="ojdeploy"
             classname="oracle.jdeveloper.deploy.ant.OJDeployAntTask"
             uri="oraclelib:OJDeployAntTask"
             classpath="${oracle.jdeveloper.ant.library}"/>
    <ora:ojdeploy xmlns:ora="oraclelib:OJDeployAntTask"
                  executable="${oracle.jdeveloper.ojdeploy.path}"
                  ora:buildscript="${taskflows.deploy.dir}/ojdeploy-build.xml"
                  ora:statuslog="${taskflows.deploy.dir}/ojdeploy-statuslog.xml">
      <ora:deploy>
        <ora:parameter name="workspace"
                       value="${taskflows.jdeveloper.workspace.path}"/>
        <ora:parameter name="project"
                       value="${taskflows.jdeveloper.project.name}"/>
        <ora:parameter name="profile"
                       value="${taskflows.adflib.profile.name}"/>
      </ora:deploy>
    </ora:ojdeploy>    
    
    <war destfile="${taskflows.deploy.dir}/${taskflows.sharedwar.deploy.outputfile}"  
        manifest="${taskflows.deploy.dir}/MANIFEST.MF" needxmlfile="false"
        webxml="${taskflows.build.home}/sharedwar_web.xml" >
        <lib  file="${taskflows.adflib.deploy.outputfile}"/>
    </war>
    
    <!--Include all additional lib in classpath -->
    <war destfile="${taskflows.deploy.dir}/${taskflows.sharedwar.deploy.outputfile}" update="true">
        <lib dir="${taskflows.lib.dir}" />      
    </war>
    
  </target>
  <target name="pre-compile"
          description="Specifies the version number for the manifest file">
    <echo> ---------------------------- </echo>
    <echo> ----Updating the manifest file with the
            correct version specification and implementation version
            ---</echo>
    <echo> ---------------------------- </echo>
      
    <if>
      <isset property="library.version"/>
      <then>
          <property name="tempManifestImpelVersion" value="${taskflows.sharedwar.specification.version}.${library.version}"/>
      </then>
      <else>
        <property name="tempManifestImpelVersion" value="${taskflows.sharedwar.specification.version}.${taskflows.sharedwar.default.implementation.version}"/>
      </else>        
  </if>  
    <copy file="${taskflows.build.home}/MANIFEST.MF.TEMPL"
          tofile="${taskflows.deploy.dir}/MANIFEST.MF"
          overwrite="true">
      <filterset>       
        <filter token="IMPLEMENTATION_VERSION" 
             value="${tempManifestImpelVersion}"/>
      </filterset>
    </copy>  
    </target>  
    <target name="init-wls">

        <condition property="wls.host" value="${wls.host.default}">
         <not>
          <isset property="wls.host"/>
         </not>
        </condition>
        <condition property="wls.port" value="${wls.port.default}">
         <not>
          <isset property="wls.port"/>
         </not>
        </condition>

        <condition property="wls.password" value="${wls.password.default}">
         <not>
          <isset property="wls.password"/>
         </not>
        </condition>
         <path id="wls.classpath">
           <fileset dir="${wls.home}/server/lib">
             <include name="**/weblogic.jar"/>
           </fileset>
         </path>
         <taskdef name="wldeploy" classpathref="wls.classpath" 
                 classname="weblogic.ant.taskdefs.management.WLDeploy"/>
    </target>
    
<target name="deploy-to-server" depends="init-wls">             
  <echo> ------------------------------------------- </echo>
  <echo> ----Deploying Shared Library to server ---- </echo>
  <echo> ------------------------------------------- </echo>  
   <wldeploy 
         action="redeploy" name="${taskflows.sharedwar.reference.name}" 
         library="true"
         usenonexclusivelock="true"         
         source="${taskflows.deploy.dir}/${taskflows.sharedwar.deploy.outputfile}"
         user="${wls.user}" password="${wls.password}"
         adminurl="t3://${wls.host}:${wls.port}"
         upload="true"
         targets="${wls.target}"/>
  <echo> ************************************************ </echo>
  <echo>     Deployment Finished. Restart WLS_Spaces       </echo>
  <echo> ************************************************ </echo>
</target>  


    
    
</project>
